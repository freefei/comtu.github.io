---
layout: post
title: 路由器工作原理
category: 网络
date: 2015-07-23
---

路由器是一种典型的网络层设备。它在两个局域网之间按帧传输数据，在OSI／RM之中被称之为中介系统，完成网络层责在两个局域网的网络层间按帧传输数据，转发帧时需要改变帧中的地址。它在OSI／RM中的位置如图1所示。

![原理](http://7u2myi.com1.z0.glb.clouddn.com/route1.jpg)

<!-- more -->

### 一、原理与作用

路由器（Router）是用于连接多个逻辑上分开的网络，所谓逻辑网络是代表一个单独的网络或者一个子网。当数据从一个子网传输到另一个子网时，可通过路由器来完成。因此，路由器具有判断网络地址和选择路径的功能，它能在多网络互联环境中，建立灵活的连接，可用完全不同的数据分组和介质访问方法连接各种子网，路由器只接受源站或其他路由器的信息，属网络层的一种互联设备。它不关心各子网使用的硬件设备，但要求运行与网络层协议相一致的软件。路由器分本地路由器和远程路由器是用业连接网络传输介质的，如光纤、同轴电缆、双绞线；远程路由器是用业连接远程传输介质，并要求相应的设备，如电话线要配调制解调器，无线要通过无线接收机、发射机。
一般说来，异种网络互联与多个子网互联都应采用路由器来完成。
路由器的主要工作就是为经过路由器的每个数据帧寻找一条最佳传输路径，并将该数据有效地传送到目的站点。由此可见，选择最佳路径的策略即路由算法是路由器的关键所在。为了完成这项工作，在路由器中保存着各种传输路径的相关数据――路径表（RoutingTable），供路由选择时使用。路径表中保存着子网的标志信息、网上路由器的个数和下一个路由器的名字等内容。路径表可以是由系统管理员固定设置好的，也可以由系统动态修改，可以由路由器自动调整，也可以由主机控制。

* 1．静态路径表
由系统管理员事先设置好固定的路径表称之为静态（Static）路径表，一般是在系统安装时就根据网络的配置情况预先设定的，它不会随未来网络结构的改变而改变。
* 2．支态路径表
动态（Dynamic）路径表是路由器根据网络系统的运行情况而自动调整的路径表。路由器根据路由选择协议（RoutingProtocol）提供的功能，自动学习和记忆网络运行情况，在需要时自动计算数据传输的最佳路径。

### 二、路由器的优缺点

* 1．优点
适用于大规模的网络；
复杂的网络拓扑结构，负载共享和最优路径；
能更好地处理多媒体；
安全性高；
隔离不需要的通信量；
节省局域网的频宽；
减少主机负担。
* 2．缺点
它不支持非路由协议；
安装复杂；
价格高。

### 三、路由器的功能

（1）在网络间载获发送到远地网段的报文，起转发的作用。

（2）选择最合理的路由，引导通信。为了实现这一功能，路由器要按照某种路由通信协议，查找路由表。路由表中列出整个互联网络中包含的各个节点，以及节点间的路径情况和与它们相联系的传输费用。如果到特定的节点有一条以上路径，则基于预先确定的准则选择最优（最经济）的路径。由于各种网络段和其相互连接情况可能发生变化，因此路由情况的信息需要及时更新，这是由所使用的路由信息协议规定的定时更新或者按变化情况更新来完成。网络中的每个路由器按照这一规则动态地更新它所保持的路由表，以便保持有效的路由信息。

（3）路由器在转发报文的过程中，为了便于在网络间传送报文按照预定的规则把大的数据包分解成适当大小的数据包，到达目的地后再把分解的数据包包装成原有形式。

（4）多协议的路由器可以连接使用不同通信协议的网络段，作为不同通信协议网络段通信连接的平台。

（5）路由器的主要任务是把通信引导到目的地网络，然后到达特定的节点站地址。后一个功能是通过网络地址分解完成的。例如，把网络地址部分的分配指定成网络、子网和区域的一组节点，其余的用来指明子网中的特别站。分层寻址允许路由器对有很多个节站的网络存储导址信息。
在广域网范围内的路由器按其转发报文的性能可以分为两种类型，即中间节点路由器和边界路由器。尽管在不断改进的各种路由协议中，对这两类路由器所使用的名称可能有很大的差别，但所发挥的作用却是一样的。
中间节点路由器在网络中传输时，提供报文的存储和转发。同时根据当前的路由表所保持的路由信息情况，选择最好的路径传送报文。由多个互连的LAN组成的公司或企业网络一侧和外界广域网相连接的路由器，就是这个企业网络的连界路由器。它从外部广域网收集向本企业网络寻址的信息，转发到企业网络中有关的网络段；另一方面集中企业网络中各个LAN段向外部广域网发送的报文，对相关的报文确定最好的传输路径。

我们通过一个例子来说明路由器工作原理。
例：工作站A需要向工作站B传送信息（并假定工作站B的IP地址为120．05），它们之间需要通过多个路由器的接力传递，路由器的分布如图2所示。

![原理](http://7u2myi.com1.z0.glb.clouddn.com/route2.jpg)

其工作原理如下：
（1）工作站A将工作站B的地址120.0.5连同数据信息以数据帧的形式发送给路由器1。

（2）路由器1收到工作站A的数据帧后，先从报头中取出地址120.0.5，并根据路径表计算出发往工作站B的最佳路径：R1－R2－R5－B；并将数据帧发往路由器2。

（3）路由器2重复路由器1的工作，并将数据帧转发给路由器5。

（4）路由器5同样取出目的地址，发现120.0.5就在该路由器所连接的网段上，于是将该数据帧直接交给工作站B。

（5）工作站B收到工作站A的数据帧，一次通信过程宣告结束。

事实上，路由器除了这一功能外，还具有网络流量控制功能。有的路由器仅支持单一协议，但大部分路由器可以支持多种协议的传输，即多协议路由器。由于每一种协议都有自己的规则，要在一个路由器中完成多种协议的算法，势必会降低路由器的性能。因此，我们以为，支持多协议的路由器性能相对较低。用户购买路由器时，需要根据自己的实际情况选择自己需要的网络协议的路由器。
近年来出现了交换路由器产品，从本质上来说它不是什么新技术，而是为了提高通信能力，把交换机的原理组合到路由器中，使数据传输能力更快、更好。


